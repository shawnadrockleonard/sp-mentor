var mentor;!function(e){var t=function(){function e(){this.contextLoaded=ko.observable(!1),this.hostweburl=ko.observable(),this.appweburl=ko.observable(),this.clientContext=ko.observable(),this.hostWeb=ko.observable(),this.appWeb=ko.observable(),this.scriptBaseUrl=ko.computed(function(){var e=this;return"undefined"!=typeof e.hostweburl()&&e.hostweburl().length>0?e.hostweburl()+"/_layouts/15/":null},this,{deferEvaluation:!0}),this.loadContext=ko.computed(function(){var e=this,t=e.hostweburl(),o=e.appweburl();e.clientContext(new SP.ClientContext(o));var n=new SP.ProxyWebRequestExecutorFactory(o);e.clientContext().set_webRequestExecutorFactory(n);var i=new SP.AppContextSite(e.clientContext(),t);return e.hostWeb(i.get_web()),e.appWeb(e.clientContext().get_web()),!0},this,{deferEvaluation:!0}),this.getHostWebDetails=function(){function e(){console.log("<b>"+o.hostWeb().get_title()+"</b>")}function t(e,t,o){console.log("Could not complete cross-domain call: "+o)}var o=this;o.clientContext().load(o.hostWeb(),"Title","Url"),o.clientContext().executeQueryAsync(Function.createDelegate(this,e),Function.createDelegate(this,t))},this.load=function(e,t){var o=this;if(o.contextLoaded())o.loadContext(),e();else{var n=decodeURIComponent(o.getQueryStringParameter("SPHostUrl"));o.hostweburl(n);var i=decodeURIComponent(o.getQueryStringParameter("SPAppWebUrl"));o.appweburl(i),jQuery.getScript(o.scriptBaseUrl()+"SP.Runtime.js",function(){jQuery.getScript(o.scriptBaseUrl()+"sp.core.js",function(){jQuery.getScript(o.scriptBaseUrl()+"SP.js",function(){jQuery.getScript(o.scriptBaseUrl()+"SP.RequestExecutor.js",function(){o.loadContext(),o.contextLoaded(!0),e()})})})})}},this.listQuery=function(e,t,o,n){var i=this,s=i.clientContext().get_web().get_lists().getByTitle(e),r=new SP.CamlQuery;r.set_viewXml(t);var l=s.getItems(r);i.clientContext().load(l),i.clientContext().executeQueryAsync(Function.createDelegate(this,function(e,t){o(e,t,l)}),Function.createDelegate(this,n))},this.getCurrentUser=function(e,t){var o=this,n=o.hostWeb().get_currentUser();o.clientContext().load(n),o.clientContext().executeQueryAsync(Function.createDelegate(null,function(t,o){e(t,o,n)}),Function.createDelegate(null,t))},this.saveMentor=function(e,t,o){var n=this,i=e.mentorTitle(),s=e.mentorCareer(),r=e.mentorCommunity(),l=e.mentorCountry(),a=e.mentorBio(),u=e.optionCareer(),c=e.optionTechnical(),m=e.optionPresentation(),h=e.mentorSkillsTechnical(),p=e.mentorSkillsProfessional(),d=e.mentorComments(),C=e.mentorUserId(),b="";jQuery.each(r,function(e,t){b+=t.Value+";#"+t.Text+";#"});var g=new SP.FieldUserValue;0!==C&&"undefined"!=typeof C&&g.set_lookupId(C);var f=n.clientContext().get_web(),x=f.get_lists().getByTitle("Mentors"),y=new SP.ListItemCreationInformation;if(this.oListItem=x.addItem(y),this.oListItem.set_item("Title",i),this.oListItem.set_item("MentorName",g),this.oListItem.set_item("MentorBio",a),this.oListItem.set_item("MentorCareer",u.toString().toUpperCase()),this.oListItem.set_item("MentorTechnical",c.toString().toUpperCase()),this.oListItem.set_item("MentorPresentation",m.toString().toUpperCase()),this.oListItem.set_item("MentorSkillsTechnical",h),this.oListItem.set_item("MentorSkillsProfessional",p),this.oListItem.set_item("MentorComments",d),"undefined"!=typeof s||null!==s){var v=new SP.FieldLookupValue;v.set_lookupId(s.Value),this.oListItem.set_item("MentorLkupCareer",v)}if("undefined"!=typeof b&&b.length>0&&this.oListItem.set_item("MentorLkupCommunity",b.substring(0,b.length-2)),"undefined"!=typeof l||null!==l){var S=new SP.FieldLookupValue;S.set_lookupId(l.Value),this.oListItem.set_item("MentorLkupCountry",S)}this.oListItem.update(),n.clientContext().load(this.oListItem),n.clientContext().executeQueryAsync(Function.createDelegate(this,t),Function.createDelegate(this,o))}}return e}();e.MentorContextModel=t}(mentor||(mentor={}));