var mentor;!function(e){var t=function(){function t(){var t=this;this.contextLoaded=ko.observable(!1),this.hostweburl=ko.observable(),this.appweburl=ko.observable(),this.scriptBaseUrl=ko.computed(function(){var e=this;return"undefined"!=typeof e.hostweburl()&&e.hostweburl().length>0?e.hostweburl()+"/_layouts/15/":null},this,{deferEvaluation:!0}),this.contextHelper=new e.spexecutor,this.loadContext=ko.computed(function(){var e=t,o=e.hostweburl(),n=e.appweburl();e.clientContext=ko.observable(new SP.ClientContext(n));var r=new SP.ProxyWebRequestExecutorFactory(n);e.clientContext().set_webRequestExecutorFactory(r);var i=new SP.AppContextSite(e.clientContext(),o);return e.hostWeb=ko.observable(i.get_web()),e.appWeb=ko.observable(e.clientContext().get_web()),!0},this,{deferEvaluation:!0})}return t.prototype.getHostWebDetails=function(){function e(){console.log("<b>"+o.hostWeb().get_title()+"</b>")}function t(e,t){console.log("Could not complete cross-domain call: "+t.get_message())}var o=this;o.clientContext().load(o.hostWeb(),"Title","Url"),o.clientContext().executeQueryAsync(e,t)},t.prototype.load=function(e,t){var o=this;if(o.contextLoaded())o.loadContext(),e();else{var n=decodeURIComponent(o.contextHelper.getQueryStringParameter("SPHostUrl"));o.hostweburl(n);var r=decodeURIComponent(o.contextHelper.getQueryStringParameter("SPAppWebUrl"));o.appweburl(r),o.loadContext(),o.contextLoaded(!0),e()}},t.prototype.listQuery=function(e,t,o,n){var r=this,i=r.clientContext().get_web().get_lists().getByTitle(e),l=new SP.CamlQuery;l.set_viewXml(t);var s=i.getItems(l);r.clientContext().load(s),r.clientContext().executeQueryAsync(function(e,t){o(e,t,s)},function(e,t){n(e,t)})},t.prototype.getCurrentUser=function(e,t){var o=this,n=o.hostWeb().get_currentUser();o.clientContext().load(n),o.clientContext().executeQueryAsync(function(t,o){e(t,o,n)},function(e,o){t(e,o)})},t.prototype.saveMentor=function(e,t,o){var n=this,r=e.mentorTitle(),i=e.mentorCareer(),l=e.mentorCommunity(),s=e.mentorCountry(),a=e.mentorBio(),u=e.optionCareer(),c=e.optionTechnical(),p=e.optionPresentation(),m=e.mentorSkillsTechnical(),d=e.mentorSkillsProfessional(),C=e.mentorComments(),b=e.mentorUserId(),f="";jQuery.each(l,function(e,t){f+=t.Value+";#"+t.Text+";#"});var x=new SP.FieldUserValue;0!==b&&"undefined"!=typeof b&&x.set_lookupId(b);var h=n.clientContext().get_web(),y=h.get_lists().getByTitle("Mentors"),v=new SP.ListItemCreationInformation,g=y.addItem(v);if(g.set_item("Title",r),g.set_item("MentorName",x),g.set_item("MentorBio",a),g.set_item("MentorCareer",u.toString().toUpperCase()),g.set_item("MentorTechnical",c.toString().toUpperCase()),g.set_item("MentorPresentation",p.toString().toUpperCase()),g.set_item("MentorSkillsTechnical",m),g.set_item("MentorSkillsProfessional",d),g.set_item("MentorComments",C),"undefined"!=typeof i||null!==i){var _=new SP.FieldLookupValue;_.set_lookupId(i.Value),g.set_item("MentorLkupCareer",_)}if("undefined"!=typeof f&&f.length>0&&g.set_item("MentorLkupCommunity",f.substring(0,f.length-2)),"undefined"!=typeof s||null!==s){var w=new SP.FieldLookupValue;w.set_lookupId(s.Value),g.set_item("MentorLkupCountry",w)}g.update(),n.clientContext().load(g),n.clientContext().executeQueryAsync(function(o,n){t(o,n,e)},function(e,t){o(e,t)})},t}();e.MentorContextModel=t}(mentor||(mentor={}));